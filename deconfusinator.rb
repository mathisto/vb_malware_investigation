require 'pry'
require 'amazing_print'

file = File.open("malware.txt")
lines = file.readlines.map(&:chomp) # ["user1", "user2", "user3"]
lines.reject! { |line| line =~ /^REM.*/ }
lines.reject! { |line| line =~ /\' .*/ }

array_capture = /^\w+ = Array.*/
const_capture = /^const /
execute_capture = /^Execute.*/

arrays = []
byte_maps = []
execution_array = []

lines.each do |line|
  if line =~ array_capture
    arrays << line[/\(.*?\)/].gsub(/[\(\)]/, '').split(',')
  elsif line =~ const_capture
  end
end

ap arrays
